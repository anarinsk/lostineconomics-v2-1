
<hr />
<p>layout: post
toc: false
comments: true
title:  LaTeX in Modern Ways
description: $\LaTeX$을 다시 써볼까?
categories: [statistics]</p>

<hr />

<p>박사 논문을 $\LaTeX$(이하 그냥 레이텍 혹은 텍이라고 쓰겠다)으로 썼지만… 역시 안 쓰면 잊는다. 갑자기 텍을 다시 써볼까, 라는 생각이 드는 순간 갑갑하더라. 윈도를 쓰건 맥을 쓰건 용량이 적지 않고 관리가 쉽지 않은 텍라이브를 까는 것이 내키는 일은 아니니까.</p>

<ul>
  <li>좀 쉽게 쓸 수 있는 방법이 없을까?</li>
  <li>가볍게 쓸 수 있는 방법은 없을까?</li>
</ul>

<p>이 두 가지를 놓고 해결책을 찾아봤다. 세 가지 정도 해법이 있다.</p>

<h2 id="tinytex-with-r">tinytex with R</h2>

<p>R의 문서 관련 패키지를 거의 혼자 만들고 있는 谢益辉(사익휘, 시에-이-휘)가 R에서 텍을 컴파일할 수 있도록 아주 가벼운 패키지 <a href="https://yihui.org/tinytex/">tinytex</a>을 만들었다. R을 쓴다면, RStudio를 쓸 것이고 편집기로서 역할 역시 훌륭하다. 그냥 RStuido 자체를 텍 문서를 만들고 컴파일하는 용도로 써도 크게 부족함은 없을 것이다.</p>

<div class="language-R highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">install.packages</span><span class="p">(</span><span class="s1">'devtools'</span><span class="p">)</span><span class="w">
</span><span class="n">devtools</span><span class="o">::</span><span class="n">install_github</span><span class="p">(</span><span class="s1">'yihui/tinytex'</span><span class="p">)</span><span class="w">
</span><span class="n">tinytex</span><span class="o">::</span><span class="n">install_tinytex</span><span class="p">()</span><span class="w">
</span></code></pre></div></div>

<ul>
  <li>devtools 패키지를 설치한다.</li>
  <li>깃헙에서 tinytex이라는 R패키지를 설치한다.</li>
  <li>tinytex 패키지를 통해서 tinytex을 설치한다.</li>
</ul>

<p>간략하게 잘 컴파일 되는지 확인해보자.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">writeLines</span><span class="p">(</span><span class="nf">c</span><span class="p">(</span><span class="w">
	</span><span class="s1">'\\documentclass{article}'</span><span class="p">,</span><span class="w">
	</span><span class="s1">'\\begin{document}'</span><span class="p">,</span><span class="w"> </span><span class="s1">'Hello world!'</span><span class="p">,</span><span class="w"> </span><span class="s1">'\\end{document}'</span><span class="w">
	</span><span class="p">),</span><span class="w"> </span><span class="s1">'test.tex'</span><span class="p">)</span><span class="w">

</span><span class="n">tinytex</span><span class="o">::</span><span class="n">pdflatex</span><span class="p">(</span><span class="s1">'test.tex'</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">test.tex</code>이라는 파일을 쓰고</li>
  <li>예를 pdflatex으로 컴파일 한다.</li>
</ul>

<h3 id="compling-tex-directly">Compling <code class="language-plaintext highlighter-rouge">.tex</code> directly</h3>

<p>이제 <code class="language-plaintext highlighter-rouge">.tex</code> 파일을 직접 컴파일 해보자. 테스트할 용도의 파일은 다음과 같다. 적당한 이름으로 아래의 tex 파일을 적당한 디렉토리에 생성하자.</p>

<div class="language-latex highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">\documentclass</span><span class="p">{</span>article<span class="p">}</span>
<span class="k">\usepackage</span><span class="p">{</span>kotex<span class="p">}</span>
<span class="nt">\begin{document}</span>
Hello world! 한글은 어떠함?
<span class="nt">\end{document}</span>
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">.tex</code> 파일을 RStudio에서 열면 위에 pdf를 생성하는 버튼을 볼 수 있다. 이걸 실행해보도록 하자. 아마도 컴파일하면 에러를 만나게 될 것이다. 한글 패키지가 제대로 설치되어 있지 않기 때문이다. 텍도 마찬가지로 패키지들을 설치해야 할 때가 많다. 몇가지 방법이 있지만, 편리한 방법을 소개하겠다.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">tinytex</span><span class="o">::</span><span class="n">parse_install</span><span class="p">(</span><span class="w">
	</span><span class="n">text</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"! LaTeX Error: File `kotex.sty' not found."</span><span class="w">
</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p>R로 돌아와서 발생한 에러 메시지를 <code class="language-plaintext highlighter-rouge">text</code>의 인자로 넣으면 어떤 패키지가 필요한지 인식해서 texlive에서 끌어와 설치한다. 설치 후 tex 패키지를 업데이트하자.</p>

<div class="language-r highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">tinytex</span><span class="o">::</span><span class="n">tlmgr_update</span><span class="p">()</span><span class="w">
</span></code></pre></div></div>

<p>이제 <code class="language-plaintext highlighter-rouge">tinytex::pdflatex('test.tex')</code>을 실행하면 pdf가 잘 생성될 것이다. 다시 <code class="language-plaintext highlighter-rouge">.tex</code> 파일로 와서 pdf 버튼을 눌러보자. 아마도 에러가 뜰 것이다. 방법 패키지를 설치했는데 왜 에러가 뜰까? 해법은 간단하다. 메뉴에서 다음과 같은 순서로 찾아들어가자.</p>

<p><kbd>Tools</kbd> -&gt; <kbd>Global Options</kbd> -&gt; <kbd>Sweave</kbd></p>

<p>“Use tinytex when compling .tex files”을 체크해주자.</p>

<h2 id="wsl--tinytex--vs-code">WSL + Tinytex + VS Code</h2>

<p>사이휘는 tinytex을 R에서만 쓰도록 만들지 않았다. 리눅스 인스톨러를 제공한다. 이 블로그를 보신 분은 잘 알겠지만, 나는 WSL의 광팬이다. WSL에 tinytex을 깔고 녀석을 VS Code에 얹어서 쓰면 된다. 물론 맥OS, 윈도 인스톨러도 제공하니 관심이 있으시면 직접 확인을 하시면 되겠다. <a href="https://yihui.org/tinytex/">홈페이지</a> 인스톨 섹션에서 확인하면 되겠다.</p>

<p>WSL 터미널에서 다음과 같이 실행하자.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>wget <span class="nt">-qO-</span> <span class="s2">"https://yihui.org/tinytex/install-bin-unix.sh"</span> | sh
</code></pre></div></div>

<p>기타 패키지 설치 등은 <code class="language-plaintext highlighter-rouge">tlmgr</code> 명령을 활용하면 된다. 위 홈페이지를 참고하면 되겠다.</p>

<p>VS Code에서는 어떤 확장을 쓰면 될까? <a href="https://marketplace.visualstudio.com/items?itemName=James-Yu.latex-workshop">Latex Workshop</a>이 PC에 깔리는 에디터 못지 않은 확장 기능을 제공한다.  extension의 <code class="language-plaintext highlighter-rouge">settings.json</code>을 통해 다양한 컴파일 옵션도 제공하니 자세한 것은 위 페이지의 안내를 참고하면 되겠다. 일단 pdflatex을 쓴다고 가정하자.</p>

<p>VS Code에서의 활용은 아래 섹션을 참고하자.</p>

<h2 id="texlive-with-docker">TexLive with Docker!</h2>

<p>본격적으로 텍을 쓰는 사람이라면 어찌해야 하나? Tinytex은 임시 방편이고 많이 부족해 보일 것이다. Texlive를 온전하게 쓰고 싶다면? 역시 OS 별로 텍라이브를 까는 방법 밖에 없나? 이럴 때 손쉽게 동원할 수 있는 게 docker이다. 사실 unix 기본으로 설계되서 텍을 맥OS에 까는 것도 부담스럽고, 윈도는 더하다. 그냥 필요할 때 불러서 쓰고 치워버리는 게 최고다. 도커는 이런 용도로 쓰기에도 아주 적합하다.</p>

<p>내가 검색해본 바로는 공인 이미지는 없는 것 같다. 다양한 사용자 이미지 중에서 꽤 관리가 잘되는 것을 골라서 쓰면 되겠다. 내가 활용하는 이미지는 다음과 같다.</p>

<p>https://hub.docker.com/r/thomasweise/docker-pandoc/</p>

<p>녀석을 도커에 마운트하자.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code>​docker run <span class="nt">-v</span> /mnt/[YOUR-LOCAL]:/doc/ <span class="nt">-t</span> <span class="nt">-i</span> thomasweise/docker-pandoc
</code></pre></div></div>

<ul>
  <li>WSL이 <code class="language-plaintext highlighter-rouge">/mnt</code> 디렉토리 아래 윈도의 디스크를 마운트한다. 따라서 저 아래 로컬 폴더의 주소를 넣으면 된다. 예를 들어, C의 doc라는 이름이라면, <code class="language-plaintext highlighter-rouge">c/doc</code>를 넣으면 된다. 이렇게 두면 해당 폴더가 도커의 <code class="language-plaintext highlighter-rouge">/doc</code> 아래 연결된다.</li>
</ul>

<p>초기에 이것저것 깔아주고 초기화해야 하는 것들이 있다. 이 녀석들을 셸스크립트(<code class="language-plaintext highlighter-rouge">sh</code>)로 만들어두자. <code class="language-plaintext highlighter-rouge">install_kotex.sh</code> 라는 스크립트는 아래와 같이 만들어보자. 해당 스크립트는 위에 마운트하는 폴더에 넣어두면 좋다. 그러면 도커 이미지가 올라갔을 때 해당 스크립에 쉽게 접근할 수 있다.</p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">#!/bin/sh</span>
tlmgr init-usertree
<span class="c">#</span>
tlmgr repository add https://cran.asia/KTUG/texlive/tlnet/ ktug
<span class="c">#tlmgr pinning add ktug "*"</span>
tlmgr <span class="nb">install </span>collection-langkorean
updmap <span class="nt">-sys</span>
updmap <span class="nt">-sys</span>
tlmgr update <span class="nt">--all</span>
</code></pre></div></div>

<p>상태를 초기화하고 한글을 까는 명령어들을 모아둔 것이다. 실행 중인 도커 내에서 해당 디렉토리로 이동해서 <code class="language-plaintext highlighter-rouge">./install_kotex.sh</code>로 명령을 실행하자.</p>

<p>이제 VS Code로 가자. 필요한 Extension은 앞서 살펴본 Latex workshop과 더불어 <a href="https://code.visualstudio.com/docs/remote/remote-overview">Remote-Container</a>를 설치하자. 이 녀석을 설치하면 WSL 내에서 돌아가는 컨테이너 안에도 VS Code를 통해 바로 접속할 수 있다.</p>

<p><img src="/lostineconomics-v2-1/images/latex/vscode_1.png" alt="" style="textalign:center; " width="500" /></p>

<ul>
  <li>아래 <code class="language-plaintext highlighter-rouge">&gt;&lt;</code>으로 된 부분을 클릭하면 상단에 메뉴가 뜬다.</li>
</ul>

<p><img src="/lostineconomics-v2-1/images/latex/vscode_2.png" alt="" style="textalign:center; " width="500" /></p>

<ul>
  <li>“attach to running container”를 실행해서 실행중인 도커 콘테이너를 부착한다.</li>
</ul>

<p><img src="/lostineconomics-v2-1/images/latex/vscode_3.png" alt="" style="textalign:center; " width="500" /></p>

<ul>
  <li>부착하면 새 창이 뜨면서 아래 녹색 창이 콘테이너 부착되었음을 알려준다.</li>
  <li>콘테이너 내부에 Latex Workshop 확장을 설치해야 한다.</li>
</ul>

<p><img src="/lostineconomics-v2-1/images/latex/vscode_4.png" alt="" style="textalign:center; " width="500" /></p>

<ul>
  <li>설치 후 해당 Extension의 설정을 고쳐주자.</li>
  <li>설정 위에 찾기에서 “pdf” 치면 pdf에 관련된 설정만 필터링된다.</li>
</ul>

<p><img src="/lostineconomics-v2-1/images/latex/vscode_5.png" alt="" style="textalign:center; " width="500" /></p>

<ul>
  <li>위 항목을 찾아서 적당한 포워딩 포트를 넣어준다.</li>
  <li>포트가 잘 포워딩 된다면, 아래와 같이 VS Code에서 PDF 뷰어를 활성화할 수 있다.</li>
  <li>포트 포워딩은 확장이 미비해서 설정해야 하는 내용이다 이후 확장의 업데이트를 통해 해결될 수 있다.</li>
</ul>

<h3 id="activating-pdf-viewer">Activating PDF Viewer</h3>

<p>확장의 PDF 뷰어의 작동 방식 때문에 포트포워딩 선택을 해줘야 한다.</p>

<h4 id="port-forward">Port Forward</h4>

<p>일단 확장 설정에서 적당히 포워딩될 포트를 설정해야 한다.</p>

<h4 id="container-setting">Container Setting</h4>

<p>콘테이너에서 해당 포트가 잘 포워딩되고 있는지 확인하자.</p>

<p>이제 VS Code에서 텍 파일을 열고 문서를 작성하고 컴파일하면 된다.</p>

<p><img src="/lostineconomics-v2-1/images/latex/vscode_6.png" alt="" style="textalign:center; " width="500" /></p>

<!--stackedit_data:
eyJoaXN0b3J5IjpbLTI4Njc5ODczLDQyMTc1MjIzN119
-->
