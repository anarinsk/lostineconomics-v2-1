<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.6.1 -->
<title>Math Behind PCA | lostineconomics.com</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Math Behind PCA" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="PCA의 수학적 이해" />
<meta property="og:description" content="PCA의 수학적 이해" />
<link rel="canonical" href="https://anarinsk.github.io/lostineconomics-v2-1/math/machine-learning/2019/05/17/math-pca.html" />
<meta property="og:url" content="https://anarinsk.github.io/lostineconomics-v2-1/math/machine-learning/2019/05/17/math-pca.html" />
<meta property="og:site_name" content="lostineconomics.com" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2019-05-17T00:00:00-05:00" />
<script type="application/ld+json">
{"mainEntityOfPage":{"@type":"WebPage","@id":"https://anarinsk.github.io/lostineconomics-v2-1/math/machine-learning/2019/05/17/math-pca.html"},"url":"https://anarinsk.github.io/lostineconomics-v2-1/math/machine-learning/2019/05/17/math-pca.html","@type":"BlogPosting","headline":"Math Behind PCA","dateModified":"2019-05-17T00:00:00-05:00","datePublished":"2019-05-17T00:00:00-05:00","description":"PCA의 수학적 이해","@context":"https://schema.org"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/lostineconomics-v2-1/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://anarinsk.github.io/lostineconomics-v2-1/feed.xml" title="lostineconomics.com" /><!-- the google_analytics_id gets auto inserted from the config file -->



<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-159914345-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-159914345-1');
</script>


<link rel="shortcut icon" type="image/x-icon" href="/lostineconomics-v2-1/images/favicon.ico"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/lostineconomics-v2-1/">lostineconomics.com</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/lostineconomics-v2-1/about/">About</a><a class="page-link" href="/lostineconomics-v2-1/search/">Search</a><a class="page-link" href="/lostineconomics-v2-1/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Math Behind PCA</h1><p class="page-description">PCA의 수학적 이해</p><p class="post-meta post-meta-title"><time class="dt-published" datetime="2019-05-17T00:00:00-05:00" itemprop="datePublished">
        May 17, 2019
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      10 min read
    
</span></p>

    
      <p class="category-tags"><i class="fas fa-tags category-tags-icon"></i></i> 
      
        <a class="category-tags-link" href="/lostineconomics-v2-1/categories/#math">math</a>
        &nbsp;
      
        <a class="category-tags-link" href="/lostineconomics-v2-1/categories/#machine-learning">machine-learning</a>
        
      
      </p>
    

    </header>

  <div class="post-content e-content" itemprop="articleBody">
    <ul class="section-nav">
<li class="toc-entry toc-h2"><a href="#tl-dr">tl; dr</a></li>
<li class="toc-entry toc-h2"><a href="#pca">PCA</a></li>
<li class="toc-entry toc-h2"><a href="#objective-function-for-pca">Objective function for PCA?</a></li>
<li class="toc-entry toc-h2"><a href="#variance-maximization">Variance Maximization</a>
<ul>
<li class="toc-entry toc-h3"><a href="#variance-covariance-matrix">Variance-covariance matrix</a></li>
<li class="toc-entry toc-h3"><a href="#eigenvalue는-어떻게-등장하나">eigenvalue는 어떻게 등장하나?</a></li>
<li class="toc-entry toc-h3"><a href="#properties-of-var-cov-matrix">Properties of var-cov matrix</a>
<ul>
<li class="toc-entry toc-h4"><a href="#대칭-행렬">대칭 행렬</a></li>
<li class="toc-entry toc-h4"><a href="#positive-definite">Positive-definite</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-entry toc-h2"><a href="#principal-component">Principal component?</a></li>
<li class="toc-entry toc-h2"><a href="#마침내-차원-축소">마침내 차원 축소</a></li>
<li class="toc-entry toc-h2"><a href="#key-questions">Key Questions</a></li>
<li class="toc-entry toc-h2"><a href="#resource">Resource</a></li>
</ul><h2 id="tl-dr">
<a class="anchor" href="#tl-dr" aria-hidden="true"><span class="octicon octicon-link"></span></a>tl; dr</h2>

<ul>
  <li>PCA를 차원을 축소하는 방법으로 막연하게 이해하지 말자. PCA 역시 다른 방법처럼 어떤 목적 함수를 최적화하는 방법의 하나다.</li>
  <li>PCA는 $k$ 개의 피처를 어떤 스크린 벡터 위에 쏴서 이를 단순화하겠다는 것이다. 이렇게 투영된 이미지와 원래 벡터와의 거리를 최소화하는 과정에서 분산 최대화라는 PCA의 새로운 목적 함수가 도출된다.</li>
  <li>PCA가 스크린으로 활용할 벡터가 하나가 아니라고 할 때, 이 여러 개의 스크린 벡터를 활용해 거리를 최소화하는 과정(즉 분산의 합을 극대화하는 과정)에서 eigenvalue와 eigenvector가 등장한다.</li>
</ul>

<h2 id="pca">
<a class="anchor" href="#pca" aria-hidden="true"><span class="octicon octicon-link"></span></a>PCA</h2>

<p>“차원의 저주”라는 표현이 있다. 언뜻 보면 자명한 이야기 같지만, 곰곰이 생각해보면 모호한 구석이 많다. 관찰 수는 많을수록 좋은데 차원은 관찰과 어떻게 다를까? 쉽게 생각해보자. 관찰 수란 활용할 수 있는 샘플의 수다. 이는 당연히 많을수록 좋다. (물론 미칠 듯이 많으면 새로운 문제가 발생하긴 하나, 대체로 우리는 샘플이 부족해서 문제를 겪는다) 하나의 샘플에서 관찰 가능한 변수가 7개라고 해보자. 샘플 수에 따라서는 적당해 보일 수 있다.</p>

<p>그런데, 샘플은 100 개인데, 한 샘플에서 관찰할 수 있는 포인트가 1,000 개라고 치자. 이 데이터 셋은 10만 개의 개별 포인트를 지닌 제법 큰 데이터 셋이지만 별 쓸모는 없다. 관찰 수에 비해서 개체의 차원이 지나치게 크기 때문이다. 이럴 경우 어떻게 차원을 줄이면 좋을까? 쉽게 생각할 수 있는 방법은 1,000 개의 특징들을 좀 줄여보는 것이다. 주성분분석(Principal Component Analysis)은 이를 위해 필요한 방법이다.</p>

<h2 id="objective-function-for-pca">
<a class="anchor" href="#objective-function-for-pca" aria-hidden="true"><span class="octicon octicon-link"></span></a>Objective function for PCA?</h2>

<p>대체로 많은 PCA에 관한 설명들이 원래 하고 싶은 게 무엇인지에 관해 묻지 않는다. PCA란 데이터의 특성을 압축하는 방법이라는 이야기만 할 뿐. 수학적으로 말하면 목적함수에 관한 질문이고 우리는 먼저 이 질문에 집중하겠다.</p>

<p>대체로 통계학의 알고리듬은 목적 함수를 최적화하는 형태이다. PCA도 마찬가지다. 관찰 대상 $i$(for $i = 1, \dotsc, n$)에 관한 $k$ 차원의 피처 벡터 $x_i$가 있다고 하자. $x_i$는 $k \times 1$의 칼럼 벡터이다. 앞으로 특별한 언급이 없는 이상 앞으로 $x_i$ 벡터는 $n$개의 관찰에 대한 평균으로 구성된 벡터 $\mu = [\mu^1~\mu^2~\dotsc~\mu^k]^T$를 뺀 값이라고 간주하자. 즉, $X_i$가 평균을 빼지 않은 $i$ 라고 할 때,</p>

<div class="kdmath">$$
\underset{k \times 1}{x_i} = \left[\begin{array}{c}{X^1_i - \mu^1} \\ {X^2_i - \mu^2} \\ {\vdots} \\ {X^k_i - \mu^k}\end{array}\right]
$$</div>

<p>이제 해당 피쳐를 쏠 스크린으로 활용할 유닛 벡터를 $w$라고 하자. 유닛 벡터란 $w \cdot w = 1$를 의미한다. 여기서 스크린이라는 의미는 개별 관찰이 지니는 특징을 이 벡터로 프로젝션해서 그 특징을 요약하겠다는 것이다. 우리에게 익숙한 회귀분석 역시 $y_i$라는 관찰을 설명변수 $\mathbf X$가 형성하는 선형 부분공간으로 프로젝션하는 방법이다. $x_i$를 $w$로 스칼라 프로젝션 하면 다음과 같다.</p>

<div class="kdmath">$$
\operatorname{Proj}_{w}(x_i) = \dfrac{w}{\Vert w \Vert} \cdot x_i = w \cdot x_ i
$$</div>

<p>이 스칼라 프로젝션의 벡터 $w$ 위의 이미지, 즉 벡터 프로젝션은 $(w \cdot x_i) \dfrac{w}{\Vert w \Vert}$이다. $\Vert w \Vert = 1$이므로 결국 벡터 프로젝션은 $(w \cdot x_i) w$가 된다.</p>

<p>이 프로젝션 스칼라 값 혹은 프로젝션 벡터의  기댓값은  아래와 같이 0이 된다.
<span class="kdmath">$\dfrac{1}{n} \sum^n_{i=1} (w \cdot x_i) = \left( \dfrac{1}{n} \sum_{i=1}^n x_i \right)\cdot w = \boldsymbol{0} \cdot w = 0$</span></p>

<p>벡터 $x_i$와 이 프로젝션 벡터 사이의 유클리드 거리를 구해보자.</p>

<div class="kdmath">$$
\begin{aligned}
\Vert x_i - (w \cdot x_i) w \Vert^2 &amp; = \Vert x_i \Vert^2 - 2 (w \cdot x_i)(w \cdot x_i) +  \Vert w \Vert^2 \\
&amp; = \Vert x_i \Vert^2 - 2 (w \cdot x_i)^2 +  1
\end{aligned}
$$</div>

<p>모든 관찰 수 $n$에 대해서 거리를 구해 더하면 이것이 일종의 MSE(Mean Squared Error)가 된다.</p>

<div class="kdmath">$$
\begin{aligned}
\mathrm{MSE}(w) &amp; = \dfrac{1}{n}\sum_{i=1}^n \left( \Vert x_i \Vert^2 - 2(w \cdot x_i)^2 + 1 \right)  \\
&amp; = \underbrace{1 +  \dfrac{1}{n}\sum_{i=1}^n \Vert x_i \Vert^2}_{(\ast)}  - 2\dfrac{1}{n}\sum_{i=1}^n  (w \cdot x_i)^2
\end{aligned}
$$</div>

<p>MSE를 최소화하는 게 목표라고 하자. 목적함수를 최적화 하기 위해서는 $w$를 조정할 수 있다. $(*)$는 $w$를 포함하고 있지 않으므로 나머지 부분을 최소화하면 MSE가 극대화된다.</p>

<div class="kdmath">$$
\dfrac{1}{n} \sum_{i=1}^n (w \cdot x_i)^2 = \left(\dfrac{1}{n}  \sum_{i=1}^n w \cdot x_i \right)^2 + \underset{i}{\mathrm{Var}}[w \cdot x_i]
$$</div>

<p>이 식이 성립하는 이유는 일반적으로 $\mathrm{Var}(y)= \mathrm{E}(y^2) - (\mathrm{E}(y))^2$이 성립하기 때문이다.  그리고 앞에서 보았듯이 $\mathrm{E} (w \cdot x_i) = 0$ 성립한다. 따라서 MSE를 최소화한다는 것은 $\mathrm{Var}_i [\cdot]$을 최대화하는 것과 같게 된다. PCA에 분산에 관한 이야기가 자꾸 나오는 것은 이 때문이다.</p>

<h2 id="variance-maximization">
<a class="anchor" href="#variance-maximization" aria-hidden="true"><span class="octicon octicon-link"></span></a>Variance Maximization</h2>

<h3 id="variance-covariance-matrix">
<a class="anchor" href="#variance-covariance-matrix" aria-hidden="true"><span class="octicon octicon-link"></span></a>Variance-covariance matrix</h3>

<p>왜 분산이 등장하는지 그리고 왜 분산이 최대화되어야 하는지 파악했으니, 이제 이를 계산해볼 차례다. 아래 행렬 $X$를 통해 쉽게 분산-공분산 행렬을  나타낼 수 있다. $x_i^j$ 에서 $i (=1,2,\dotsc, n)$는 관찰을, $j(=1,2,\dotsc,k)$는 피쳐를 나타낸다.</p>

<div class="kdmath">$$
\underset{n \times k}{X} = 
 \begin{bmatrix}
    {x_1}^T \\
    {x_2}^T  \\
    \vdots \\
    {x_n}^T 
\end{bmatrix} =  
\begin{bmatrix}
{x_1^1} &amp; {x_1^2} &amp; {\cdots} &amp; {x_1^k} \\ 
{x_2^1} &amp; {x_2^2} &amp; {\cdots} &amp; {x_2^k}\\ 
{\vdots} &amp; {\vdots} &amp; {\ddots} &amp; {\vdots} \\ 
{x_n^1} &amp; {x_n^2} &amp; {\cdots} &amp; {x_n^k}
\end{bmatrix}
$$</div>

<div class="kdmath">$$
\begin{aligned}
\dfrac{1}{n-1} \underset{(k \times n) (n \times k)}{X^{T} X} = 
\begin{bmatrix}
\text{cov}(x^1, x^1) &amp; \text{cov}(x^1, x^2) &amp; \cdots &amp; \text{cov}(x^1, x^k) \\
\text{cov}(x^2, x^1) &amp; \text{cov}(x^2, x^2) &amp; \cdots &amp; \text{cov}(x^2, x^k) \\
\text{cov}(x^k, x^1) &amp; \text{cov}(x^k, x^2) &amp; \cdots &amp; \text{cov}(x^k, x^k)
\end{bmatrix} = \Sigma, \text{~where}
\end{aligned}
$$</div>

<div class="kdmath">$$
\text{cov}(x^i, x^j) = \dfrac{1}{n-1}\sum_{k=1}^{n} x^i_k x^j_k
$$</div>

<h3 id="eigenvalue는-어떻게-등장하나">
<a class="anchor" href="#eigenvalue%EB%8A%94-%EC%96%B4%EB%96%BB%EA%B2%8C-%EB%93%B1%EC%9E%A5%ED%95%98%EB%82%98" aria-hidden="true"><span class="octicon octicon-link"></span></a>eigenvalue는 어떻게 등장하나?</h3>

<p>임의의 단위 벡터 $w$와 그 프로젝션을 다시 적어보자. 표기를 간단히 하기 위해서 상첨자는 생략한다. 이제 하나의 벡터가 아니라 $X$라는 매트릭스 전체에 대해서 프로젝션을 하면 아래와 같다.</p>

<div class="kdmath">$$
\operatorname{Proj}_{w} (X) = \dfrac{X w}{\Vert w \Vert} \in {\mathbb R}^{n \times 1}
$$</div>

<p>이제 극대화의 목적은 이렇게 프로젝션된 이미지의 분산을 가장 크게 만드는 것이다.  앞서의 가정에 따라서 $\mathrm{E}(X) = 0$가 성립함을 기억해두자.</p>

<div class="kdmath">$$
\begin{aligned}
\mathrm{Var}(X {w}) &amp;= \frac{1}{n-1}(X {w})^{T}(X {w}) \\
&amp;=\frac{1}{n-1} {w}^{T} X^{T} X {w} =\frac{1}{n-1} {w}^{T}\left(X^{T} X\right) {w} \\
&amp;={w}^{T}\left(\frac{X^{T} X}{n-1}\right) {w} \\
&amp;={w}^{T} \Sigma {w}
\end{aligned}
$$</div>

<p>그런데, $w$는 단위벡터임으로 $w \cdot w = 1$이다. 이를 제약 조건으로 두고 제약 하의 극대화 문제를 정식화하면 다음과 같다.</p>

<div class="kdmath">$$
{\mathcal L} =w^{\operatorname T} \Sigma w - \lambda (w \cdot w -1)
$$</div>

<div class="kdmath">$$
\begin{aligned}
\dfrac{\partial \mathcal L}{\partial w} &amp; = 0 = 2 \Sigma w - 2\lambda w \\
\dfrac{\partial \mathcal L}{\partial \lambda} &amp; = 0 = w \cdot w - 1
\end{aligned}
$$</div>

<p>1계 조건을 다시 보자.<sup id="fnref:4" role="doc-noteref"><a href="#fn:4" class="footnote" rel="footnote">1</a></sup> $\Sigma w = \lambda w$ 조건이 흥미롭다. 1계 조건이 정확하게 아이겐밸류(eigenvalue, 고유값)와 아이겐벡터(eigenvector, 고유벡터)를 구하는 방법이다. 어떤 매트릭스가 있을 때 해당 매트릭스의 분산-공분산 행렬의 아이겐밸류와 아이겐벡터를 구하면 그 아이겐밸류와 벡터가 바로 MSE를 최적화해주는 값이 된다. 이때 $w$는 아이겐벡터이며 $\lambda$는 아이겐밸류가 된다.  아이겐밸류는 아래 식에서 보듯이 분산이다.<sup id="fnref:2" role="doc-noteref"><a href="#fn:2" class="footnote" rel="footnote">2</a></sup></p>

<div class="kdmath">$$
\operatorname{Var}(X w) = w^{\mathrm T} \Sigma w =  w^{\mathrm T} (\lambda w)  = \lambda w \cdot w = \lambda
$$</div>

<p>아마도 최적화 공부를 해본 사람이라면 갸우뚱할지 모르겠다. 1계 조건은 필요 조건이다. 즉, 극대화, 극소화 모두를 그 안에 담고 있을 수 있다. 그렇다면 2계 충분 조건을 따져야 하지 않을까? 그런데, 위 식에 대해서 사실 2계 충분 조건을 따지는 것이 쉽지 않다. 다만 이 문제는 다행스럽게도 지름길이 있다. 위에서 보듯이 1계 조건을 만족하는 $w$는 $\Sigma$의 아이겐벡터다. 따라서 이 아이겐벡터에서만 극대값과 극소값이 존재한다. 1계 조건을 만족하는 아이겐벡터를 $\omega$라고 하자.</p>

<div class="kdmath">$$
\begin{aligned}
{\mathcal L}(\omega) &amp; =\omega^{T} \Sigma \omega - \lambda (\omega \cdot \omega -1) \\
&amp; = \omega^T (\Sigma w - \lambda w) + \lambda \\
&amp; = \lambda 
\end{aligned}
$$</div>

<p>즉, 1계 조건을 만족하는 값에서 목적 함수의 값은 아이겐밸류 $\lambda$가 된다. 그리고 위에서 보았듯이 $\lambda$는 $Xw$의 분산이 되기 때문에 분산이 큰 값의 아이겐벡터가 목적 함수를 극대화하는 $w$가 된다.</p>

<p>앞서 $\lambda$가 분산이 된다고 말했다. 잠깐, 분산이라면 항상 0보다 커야 하는데, $\lambda$가 0보다 크다는 보장이 있는가? 이 문제를 포함하여 앞에서 정리하지 못한 몇 가지 문제를 모아서 살펴보자.</p>

<h3 id="properties-of-var-cov-matrix">
<a class="anchor" href="#properties-of-var-cov-matrix" aria-hidden="true"><span class="octicon octicon-link"></span></a>Properties of var-cov matrix</h3>
<p>분산-공분산 행렬은 아래와 같은 두 가지 특징을 지닌다.</p>

<h4 id="대칭-행렬">
<a class="anchor" href="#%EB%8C%80%EC%B9%AD-%ED%96%89%EB%A0%AC" aria-hidden="true"><span class="octicon octicon-link"></span></a>대칭 행렬</h4>

<p>우선, 분산-공분산 행렬이므로 대칭이다. 행렬이 대칭일 경우 아이겐밸류는 모두 실수이며 아이겐벡터들은 서로 직교(orthogonal)한다.</p>

<p>For $i, j \in { 1, 2, \dotsc, k}~\text{with}~i \ne j, w^i \cdot w^j = 0$, and for $i \in { 1, 2, \dotsc, k}~, w^i \cdot w^i =1$</p>

<p>여러개의 프로젝션 스크린 벡터들이 존재할 경우 해당 벡터들이 서로 직교하면 분산값의 합을 최대화하는 것과 MSE를 최소화하는 것이 같은 의미를 지닌다. 이 조건이 분산-공분산 행렬의 속성을 통해 성립한다.</p>

<p>분산-공분산 행렬의 이 특징이 PCA의 흥미로운 점 하나를 드러난다. 2 차원 평면에서 사 분면을 떠올려보자. 사 분면을 구성하는 $x$, $y$ 축은 서로 직교한다. 2 차원 평면 위에 어떤 관찰에 대해서 PCA를 했다고 하자. PCA의 스크린으로 두 개를 사용했고, 해당 스크린이 아이겐벡터라면 이 두 벡터는 서로 직교한다. 즉, 원래 직교했던 두 축에서 직교하는 다른 두 축으로 좌표의 기준을 이동하는 개념이다. 즉 PCA는 분산을 가장 크게 하는 방식으로 좌표축을 이동하는 방법이라고 이해하면 좋겠다. PCA에 관한 소개에서 아래의 그림처럼 축을 돌린 예시가 자주 등장하는 까닭이기도 하겠다.<sup id="fnref:5" role="doc-noteref"><a href="#fn:5" class="footnote" rel="footnote">3</a></sup></p>

<p align="center"><kbd>
  <img src="https://github.com/anarinsk/lie-math_pca/blob/master/assets/imgs/pca_example.png?raw=true" width="500">
</kbd></p>

<h4 id="positive-definite">
<a class="anchor" href="#positive-definite" aria-hidden="true"><span class="octicon octicon-link"></span></a>Positive-definite</h4>

<p>$\Sigma$는 준양정행렬(positive semi-definite) 행렬이다.<sup id="fnref:1" role="doc-noteref"><a href="#fn:1" class="footnote" rel="footnote">4</a></sup> 즉,</p>

<div class="kdmath">$$
x^T \Sigma x \geq 0 ~\text{for any $x$.}
$$</div>

<p><span class="kdmath">$w^T X^T X w = \underset{\text{닷 프로덕트}}{ (Xw)^T (Xw) } \geq 0$</span></p>

<p>이 경우 모든 아이겐밸류의 값은 음수가 되지 않는다. 앞서 아이겐밸류가 분산이 된다는 사실을 보았다. 아이겐밸류가 음수가 될 수 없고 따라서 분산이 될 수 있다.</p>

<h2 id="principal-component">
<a class="anchor" href="#principal-component" aria-hidden="true"><span class="octicon octicon-link"></span></a>Principal component?</h2>

<p>프로젝션 스크린 벡터 $w$에 따른 극대화 문제를 풀면 아이겐밸류와 아이겐벡터를 각각 하나씩 얻게 된다. $k$ 개의 스크린 벡터 혹은 아이겐벡터가 가능하다고 할 때,  분산(아이겐밸류)이 큰 순서대로 아이겐벡터를 정렬한다고 생각해보자. 이렇게 정렬하면 프로젝션 스크린 벡터 중에서 MSE를 더 줄일 수 있는 벡터 순으로 정렬하는 셈이다. 이렇게 분산이 큰 순서대로 나열한 서로 다른 스크린벡터가 바로 주성분(pricipal component)다.</p>

<p>$k$ 개의 주성분 중에서 임의로 $l$ 개를 취한다면(이게 차원 축소가 아닐까?), MSE를 낮추기 위해서는 분산이 큰 순서대로, 즉 아이겐밸류가 큰 순서대로 주성분을 취하면 된다. 이게 PCA를 직관적으로 이해하는 방법이다.</p>

<p>그런데 한 가지 찜찜한 점이 남는다. 주성분은 이렇게 순서대로 취할 수 있다는 것은 주성분을 결합해서 더 큰 분산을 얻을 수 없을 때만 가능하다. 예컨대, $w_1$과 $w_2$를 적당히 선형결합해 분산을 높일 수 있다면 분산이 큰 순서대로 아이겐벡터를 선택한다는 논의는 깨지게 된다. 이 가능성을 살펴봐야 하겠다.</p>

<p>프로젝션의 스크린으로 동원되는 벡터가 $w^1, w^2, \dotsc, w^k$라고 하자. 이 프로젝션을 통해 생성되는 벡터들이 이루는 부분공간은 다음과 같이 나타낼 수 있다.</p>

<div class="kdmath">$$
\sum_{j=1}^k \underset{\mathrm{가중치}}{( x_i \cdot w^j) } w^j
$$</div>

<p>$x_i$와 $w^j$ 모두 $k \times 1$ 벡터임을 확인하고 가자. 이 녀석과 $x_i$의 MSE를 최소화하는 문제는 어떻게 될까? 계산이 다소 복잡하니 직관만 짚고 넘어가자.</p>

<ol>
  <li>앞서 스크린이 하나였던 경우와 마친가지로 $x_i$와 저 값의 내적의 분산을 최대화 해야 한다.</li>
  <li>만일 $w_\cdot$들이 서로 직교한다면, $w_i \cdot w_j (i \neq j)$는 0이 되어 사라질 것이고, $w_i \cdot w_i$(=1)로 구성된 텀만 만게 된다.  결국</li>
  <li>스크린을 이루는 축들과 $x_i$의 크로스 프로덕트 값의 분산($\mathrm{Var} (x_i \cdot w^j)$)을 더한 값을 최대화하는 것이 MSE를 극소화 문제가 된다. 즉, 각각 $w^j$와 $x_i$의 닷 프로덕트의 분산을 최대화하면 된다. 즉,</li>
</ol>

<div class="kdmath">$$
\underset{i}{\text{Var}}[\sum_{j=1}^k {( x_i \cdot w^j) } w^j] = \sum_{j=1}^k {\lambda^j}
$$</div>

<h2 id="마침내-차원-축소">
<a class="anchor" href="#%EB%A7%88%EC%B9%A8%EB%82%B4-%EC%B0%A8%EC%9B%90-%EC%B6%95%EC%86%8C" aria-hidden="true"><span class="octicon octicon-link"></span></a>마침내 차원 축소</h2>

<p>이제 마침내 차원 축소를 다룰 수 있다!  앞서 MSE 최소화 문제에서 보았듯이 분산이 클수록 좋다. 임의의 갯수로 주성분을 취한다고 할 때 의 기준은 분산이 큰 순서이고  분산은 아이겐밸류와 같다. $l(&lt;k)$ 개의 주성분을 취할 때 취할 때 아이겐밸류가 큰 순서대로 취하면 되겠다.<sup id="fnref:3" role="doc-noteref"><a href="#fn:3" class="footnote" rel="footnote">5</a></sup></p>

<h2 id="key-questions">
<a class="anchor" href="#key-questions" aria-hidden="true"><span class="octicon octicon-link"></span></a>Key Questions</h2>

<p><strong>Q1.</strong> MSE 최소화는 무엇으로 연결되는가?</p>

<blockquote>
  <p>$Xw$의 분산을 최대화하는 것이다.</p>
</blockquote>

<p><strong>Q2.</strong> 아이겐밸류 아이겐벡터는 어떻게 등장하는가?</p>

<blockquote>
  <p>$Xw$의 분산을 $w^T w =1$의 제약하에서 극대화할 때 1계 조건에서 등장한다.</p>
</blockquote>

<p><strong>Q3.</strong> 아이겐벡터와 아이겐밸류는 어떤 특징을 지니고 있는가?</p>

<blockquote>
  <p>1계 조건에서 아이겐벡터와 아이겐밸류를 찾아야 하는 매트릭스는 var-cov 행렬 $\Sigma$다. 그리고 이 행렬은 대칭행렬이며 Positive definite 행렬이다. 이 조건으로부터, 아이겐벡터들은 서로 orthogonal하고, 아이겐밸류는 모두 양수이다.</p>
</blockquote>

<p><strong>Q4.</strong> 결국 PCA란 무엇인가?</p>

<blockquote>
  <p>분산이 큰 순서대로 $k$ 개의 주성분 중에서 임의로 $l(&lt;k)$ 개의 아이겐벡터를 선택하는 것이다. 그리고 이 아이겐벡터는 일종의 피처에 관한 가중치로 이해할 수 있다.</p>
</blockquote>

<h2 id="resource">
<a class="anchor" href="#resource" aria-hidden="true"><span class="octicon octicon-link"></span></a>Resource</h2>

<p>이 글은 아래 자료를 바탕으로 만들었습니다.</p>

<p><a href="https://www.stat.cmu.edu/~cshalizi/350/lectures/10/lecture-10.pdf">https://www.stat.cmu.edu/~cshalizi/350/lectures/10/lecture-10.pdf</a></p>

<!--stackedit_data:
eyJoaXN0b3J5IjpbLTE3NDAyMjMzMzEsLTY2NzA3Mzg1MV19
-->
<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:4" role="doc-endnote">
      <p>사실 여기 적은 1계 조건은 엄밀하지 않다. 이해를 돕기 위해서 여러가지를 퉁쳤는데, 최적화의 결과는 동일하다. 보다 상세한 도출은 <a href="https://stats.stackexchange.com/questions/10251/what-is-the-objective-function-of-pca">여기</a>를 참고하시기 바란다. <a href="#fnref:4" class="reversefootnote" role="doc-backlink">↩</a></p>
    </li>
    <li id="fn:2" role="doc-endnote">
      <p>흥미로운 일치를 확인하셨는지? 제약 하 극대화에서 라그랑쥬 승수와 아이겐밸류를 나타내는 수학 기호가 모두 $\lambda$다. 약간 소름 돋는 대목이다. 일치는 여기서 끝나지 않는다. 라그랑쥬 승수는 제약 하의 극대화에서 잠재 가격(shadow price)로 불리기도 한다. 이는 해당 조건이 제약하는 자원의 잠재적인 가치를 나타낸다. 이는 분산이 클수록 MSE가 작다는 PCA의 목적 함수의 해석과 일치한다. <a href="#fnref:2" class="reversefootnote" role="doc-backlink">↩</a></p>
    </li>
    <li id="fn:5" role="doc-endnote">
      <p>하나 주의할 점이 있다. 이 그림은 차원 회전에 관한 것이지 차원 축소에 관한 것이 아니다. 즉, 변이가 잘 드러나도록 축을 회전할 수 있다는 예시다. 축소는 다른 문제인데, 아래 본문의 내용에서 보듯이 축을 돌려 변이를 상당 부분 설명했다면 변이의 설명력이 낮은 축들을 제거할 수 있다는 것이 차원 축소다. <a href="#fnref:5" class="reversefootnote" role="doc-backlink">↩</a></p>
    </li>
    <li id="fn:1" role="doc-endnote">
      <p>증명은 몹시 간단하다. $w^T \Sigma w$ 라고 하자. <a href="#fnref:1" class="reversefootnote" role="doc-backlink">↩</a></p>
    </li>
    <li id="fn:3" role="doc-endnote">
      <p>주성분의 갯수를 취하는 방법은 PCA에 관한 튜토리얼에서 항상 등장하는 주제이니 구글링을 해서 확인하시면 되겠다. <a href="#fnref:3" class="reversefootnote" role="doc-backlink">↩</a></p>
    </li>
  </ol>
</div>

  </div><!-- from https://github.com/utterance/utterances -->
<script src="https://utteranc.es/client.js"
        repo="anarinsk/lostineconomics-v2-1"
        issue-term="title"
        label="blogpost-comment"
        theme="github-light"
        crossorigin="anonymous"
        async>
</script><a class="u-url" href="/lostineconomics-v2-1/math/machine-learning/2019/05/17/math-pca.html" hidden></a>
</article>
      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/lostineconomics-v2-1/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/lostineconomics-v2-1/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/lostineconomics-v2-1/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>A useless and aimless blog</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/anarinsk" target="_blank" title="anarinsk"><svg class="svg-icon grey"><use xlink:href="/lostineconomics-v2-1/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/anarinsk" target="_blank" title="anarinsk"><svg class="svg-icon grey"><use xlink:href="/lostineconomics-v2-1/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
